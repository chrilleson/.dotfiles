- defaults:
    link:
      relink: true
      create: true
    shell:
      stdout: true
      stderr: true

- clean:
    ~/:
      force: true
    ~/AppData/Roaming/nushell:
      force: true

- link:
    # Nushell
    ~/AppData/Roaming/nushell/config.nu: nushell/config.nu
    ~/AppData/Roaming/nushell/env.nu: nushell/env.nu
    ~/AppData/Roaming/nushell/scripts: nushell/scripts
    
    # Git
    ~/.gitconfig: git/gitconfig
    ~/.gitignore_global: git/gitignore_global
    
    # Starship prompt
    ~/.config/starship.toml: starship/starship.toml
    
- create:
    - ~/AppData/Roaming/nushell
    - ~/AppData/Roaming/nushell/scripts

- shell:
    - description: Installing Scoop packages
      command: |
        if (!(Get-Command scoop -ErrorAction SilentlyContinue)) {
          Write-Host "Scoop not installed. Install from https://scoop.sh"
        } else {
          scoop bucket add extras
          scoop bucket add nerd-fonts
          scoop install git starship nushell
          # Optional: Install a nerd font for better terminal icons
          # scoop install FiraCode-NF-Mono
        }
      
    - description: Setting up Git
      command: git config --global core.excludesfile ~/.gitignore_global