- defaults:
    link:
      relink: true
      create: true

- clean: ['~']

# Create XDG directories on Linux/macOS
- shell:
  - description: Create XDG directories
    command: mkdir -p ~/.config ~/.local/bin ~/.local/share ~/.local/state ~/.cache
    stdout: true
    stderr: true
    quiet: true

# Symlink configurations
- link:
    # Nushell config (cross-platform)
    ~/.config/nushell:
      path: windows/nushell
      create: true

    # Git config (cross-platform)
    ~/.gitconfig:
      path: shared/git/gitconfig
    ~/.gitignore:
      path: shared/git/gitignore_global

    # Starship (cross-platform prompt)
    ~/.config/starship.toml:
      path: shared/starship/starship.toml
      if: '[ -d ~/.config ] || [ "$(uname)" = "Windows_NT" ]'

    # Neovim (cross-platform)
    ~/.config/nvim:
      path: shared/nvim
      create: true

    # WezTerm (Windows only â€” Linux uses Ghostty, macOS uses Ghostty or native)
    ~/.wezterm.lua:
      path: windows/wezterm/wezterm.lua
      if: '[ "$(uname)" = "Windows_NT" ]'

    # VS Code (platform-aware)
    ~/.config/Code/User/settings.json:
      path: windows/vscode/settings.json
      if: '[ "$(uname)" = "Linux" ]'
      create: true
    ~/.config/Code/User/keybindings.json:
      path: windows/vscode/keybindings.json
      if: '[ "$(uname)" = "Linux" ]'
      create: true

    # Node configs (cross-platform)
    ~/.npmrc:
      path: shared/node/.npmrc
      if: '[ -f shared/node/.npmrc ]'
    ~/.eslintrc.json:
      path: shared/node/eslintrc.json
      if: '[ -f shared/node/eslintrc.json ]'
    ~/.prettierrc.json:
      path: shared/node/.prettierrc
      if: '[ -f shared/node/.prettierrc ]'

# Fish shell (Linux)
- link:
    ~/.config/fish/config.fish:
      path: linux/fish/config.fish
      if: '[ "$(uname)" = "Linux" ]'
      create: true
    ~/.config/fish/conf.d/starship.fish:
      path: linux/fish/conf.d/starship.fish
      if: '[ "$(uname)" = "Linux" ]'
      create: true
    ~/.config/fish/conf.d/fnm.fish:
      path: linux/fish/conf.d/fnm.fish
      if: '[ "$(uname)" = "Linux" ]'
      create: true
    ~/.config/fish/conf.d/zoxide.fish:
      path: linux/fish/conf.d/zoxide.fish
      if: '[ "$(uname)" = "Linux" ]'
      create: true
    ~/.config/fish/conf.d/fzf.fish:
      path: linux/fish/conf.d/fzf.fish
      if: '[ "$(uname)" = "Linux" ]'
      create: true
    ~/.config/fish/functions/dev.fish:
      path: linux/fish/functions/dev.fish
      if: '[ "$(uname)" = "Linux" ]'
      create: true

# Ghostty (Linux)
- link:
    ~/.config/ghostty/config:
      path: linux/ghostty/config
      if: '[ "$(uname)" = "Linux" ]'
      create: true

# Tmux (Linux)
- link:
    ~/.config/tmux/tmux.conf:
      path: linux/tmux/tmux.conf
      if: '[ "$(uname)" = "Linux" ]'
      create: true

# Opencode config (Linux/macOS)
- link:
    ~/.config/opencode/config.json:
      path: shared/opencode/opencode.json
      if: '[ "$(uname)" = "Linux" ] || [ "$(uname)" = "Darwin" ]'
      create: true

# Create local git config if it doesn't exist
- shell:
  - description: Create local gitconfig
    command: test -f ~/.gitconfig-local || cp shared/git/gitconfig-local.example ~/.gitconfig-local
    stdout: true
    stderr: true
